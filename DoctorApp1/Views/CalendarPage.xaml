<?xml version="1.0" encoding="utf-8" ?>
<!--
    CalendarPage.xaml
    Displays a calendar for viewing, adding, editing, and deleting patient appointments.
    - Users can switch between day and week views.
    - Appointments are listed for the selected date or week.
    - Add/Edit/Delete actions are available directly from the page.
    - Modal overlay is used for appointment creation and editing, with patient and time selection.
    Note: To avoid XLS0501 ("Content is set more than once"), wrap all content in a single layout container (e.g., Grid).
-->
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="DoctorApp1.Views.CalendarPage"
             Title="Appointments Calendar">

    <!--
        Use a Grid as the root layout to allow overlaying the modal on top of the main content.
        This avoids setting the Content property more than once.
    -->
    <Grid>
        <!-- Main calendar content with scrolling enabled -->
        <ScrollView>
            <StackLayout Padding="20" Spacing="12">
                <!-- Page Title -->
                <Label Text="Appointments Calendar"
                       FontSize="26"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"
                       Margin="0,0,0,10"/>

                <!-- View mode switcher: allows user to toggle between day and week views -->
                <StackLayout Orientation="Horizontal" HorizontalOptions="Center" Spacing="12">
                    <Button Text="Day" Clicked="OnDayViewClicked" StyleClass="SwitchButton"/>
                    <Button Text="Week" Clicked="OnWeekViewClicked" StyleClass="SwitchButton"/>
                </StackLayout>

                <!-- Month picker for selecting the month/year -->
                <HorizontalStackLayout HorizontalOptions="Center" Spacing="10" Margin="0,8,0,8">
                    <Picker x:Name="MonthPicker" Title="Month" WidthRequest="110" HeightRequest="76" FontSize="15"/>
                    <Picker x:Name="YearPicker" Title="Year" WidthRequest="90" HeightRequest="76" FontSize="15"/>
                </HorizontalStackLayout>

                <!-- Calendar grid for the selected month -->
                <Frame x:Name="CalendarFrame" HasShadow="True" Padding="0" CornerRadius="16" Margin="0,5,0,0" BackgroundColor="#F5F5F5">
                    <Grid x:Name="CalendarGrid"
                        RowSpacing="3"
                        ColumnSpacing="3"
                        Padding="3"
                        BackgroundColor="#F5F5F5"/>
                </Frame>

                <!-- Button to add a new appointment -->
                <Button Text="Add Appointment"
                        Clicked="OnAddAppointmentClicked"
                        Margin="0,18,0,0"
                        CornerRadius="14"
                        BackgroundColor="#4D90FE"
                        TextColor="White"
                        FontAttributes="Bold"
                        HeightRequest="44"/>
            </StackLayout>
        </ScrollView>

        <!--
            Modal overlay for adding/editing appointments.
            - Includes patient picker, time pickers, and notes editor.
            - Save and Cancel actions.
            - IsVisible is controlled from code-behind.
        -->
        <ContentView x:Name="AppointmentModal" IsVisible="False" BackgroundColor="#80000000"
             Grid.RowSpan="1" Grid.ColumnSpan="1">
    <Border Padding="20" StrokeShape="RoundRectangle 20"
        BackgroundColor="#FFFFFF"
        VerticalOptions="Center" HorizontalOptions="Center" WidthRequest="350">
        <StackLayout Spacing="16">
            <Label Text="{Binding ModalTitle}" FontSize="20" FontAttributes="Bold" HorizontalOptions="Center"/>
            <Picker x:Name="PatientPicker" Title="Select Patient"/>
            <DatePicker x:Name="DatePicker" />
            <TimePicker x:Name="StartTimePicker" />
            <TimePicker x:Name="EndTimePicker" />
            <Editor x:Name="NotesEditor" Placeholder="Notes" HeightRequest="60"/>
            <StackLayout Orientation="Horizontal" HorizontalOptions="End" Spacing="10">
                <Button Text="Save" Clicked="OnSaveModal"/>
                <Button Text="Cancel" Clicked="OnCancelModal"/>
            </StackLayout>
        </StackLayout>
    </Border>
</ContentView>
    </Grid>
</ContentPage>